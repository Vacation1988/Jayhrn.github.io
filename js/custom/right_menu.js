const str_1='<div style="background: #121212;height:100vh;text-align: center;"><img src="https://i.loli.net/2020/05/19/aKOcLiyPl2JQdFD.png" style="margin:12em auto 0; height: 16em;"><div style="color: rgba(255, 255, 255, .7);width: 100%;font-size: 1.7em;text-align: center;font-weight: bold;padding: 30px auto;margin-top: 15px;">这个网站炸了，<a href="/" style="color:#99a9bf;background-color: #1f1f1f;padding: .4em .5em;text-decoration: none;border-radius:4px">点击返回试试吧~</a></div></div>';document.onkeydown=function(e){return 123==e.keyCode||e.ctrlKey&&e.shiftKey&&(74===e.keyCode||73===e.keyCode||67===e.keyCode)||e.ctrlKey&&85===e.keyCode?btf.snackbarShow("开发者模式已打开，请遵循GPL协议",!1,3e3):(e.ctrlKey||e.metaKey)&&67==e.keyCode&&""!=selectTextNow?(btf.snackbarShow("复制成功"),rightmenuCopyText(selectTextNow),!1):void 0},function(){var e=document.createElement("div");Object.defineProperty(e,"id",{get:function(){try{return document.body.innerHTML=str_1}catch(e){}return document.body.innerHTML=str_1}})}();let rm={showRightMenu:function(e,t=0,n=0){let o=$("#rightMenu");o.css("top",t+"px").css("left",n+"px"),e?(stopMaskScroll(),o.show()):o.hide()}},rmWidth=$("#rightMenu").width(),rmHeight=$("#rightMenu").height();rm.reloadrmSize=function(){rmWidth=$("#rightMenu").width(),rmHeight=$("#rightMenu").height()};let domhref="",domImgSrc="",selectTextNow="";function selceText(){let e;e=document.selection?document.selection.createRange().text:window.getSelection()+"",selectTextNow=e||""}function removeRightMenu(){rm.showRightMenu(!1),$("#rightmenu-mask").attr("style","display: none")}function stopMaskScroll(){if(document.getElementById("rightmenu-mask")){document.getElementById("rightmenu-mask").addEventListener("mousewheel",(function(e){removeRightMenu()}),!1)}if(document.getElementById("rightMenu")){document.getElementById("rightMenu").addEventListener("mousewheel",(function(e){removeRightMenu()}),!1)}}function switchDarkMode(){removeRightMenu();"light"===("dark"===document.documentElement.getAttribute("data-theme")?"dark":"light")?(activateDarkMode(),saveToLocal.set("theme","dark",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(activateLightMode(),saveToLocal.set("theme","light",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),"function"==typeof utterancesTheme&&utterancesTheme(),"object"==typeof FB&&window.loadFBComment(),window.DISQUS&&document.getElementById("disqus_thread").children.length&&setTimeout((()=>window.disqusReset()),200)}function copyUrl(e){$("body").after("<input id='copyVal'></input>");var t=e,n=document.getElementById("copyVal");n.value=t,n.select(),n.setSelectionRange(0,n.value.length),document.execCommand("copy"),$("#copyVal").remove()}function copyPageUrl(){copyUrl(window.location.href),btf.snackbarShow("复制本页链接地址成功"),removeRightMenu()}function rightmenuCopyText(e,t="no-add"){const n=GLOBAL_CONFIG.copyright;var o;o="add-copyright"==t&&e.length>n.limitCount?e+"\n\n\n"+n.languages.author+"\n"+n.languages.link+window.location.href+"\n"+n.languages.source+"\n"+n.languages.info:e,navigator.clipboard&&navigator.clipboard.writeText(o),removeRightMenu()}function imageToBlob(e){const t=new Image;image.crossOrigin="Anonymous";const n=document.createElement("canvas"),o=n.getContext("2d");return t.crossOrigin="",t.src=e,new Promise((e=>{t.onload=function(){n.width=this.naturalWidth,n.height=this.naturalHeight,o.drawImage(this,0,0),n.toBlob((t=>{e(t)}),"image/png",.75)}}))}async function copyImage(e){const t=await imageToBlob(e),n=new ClipboardItem({"image/png":t});navigator.clipboard.write([n])}function writeClipImg(e){removeRightMenu(),btf.snackbarShow("正在下载中，请稍后",!1,1e4),0==rm.downloadimging&&(rm.downloadimging=!0,setTimeout((function(){copyImage(e),btf.snackbarShow("复制成功！图片已添加盲水印，请遵守版权协议"),rm.downloadimging=!1}),"10000"))}function downloadImage(e,t){removeRightMenu(),0==rm.downloadimging?(rm.downloadimging=!0,btf.snackbarShow("正在下载中，请稍后",!1,1e4),setTimeout((function(){let n=new Image;n.setAttribute("crossorigin","anonymous"),n.onload=function(){let e=document.createElement("canvas");e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(n,0,0,n.width,n.height);let o=e.toDataURL("image/png"),i=document.createElement("a"),c=new MouseEvent("click");i.download=t||"photo",i.href=o,i.dispatchEvent(c)},n.src=e,btf.snackbarShow("图片已添加盲水印，请遵守版权协议"),rm.downloadimging=!1}),"10000")):btf.snackbarShow("有正在进行中的下载，请稍后再试")}function searchBaidu(){btf.snackbarShow("即将跳转到百度搜索"),setTimeout((function(){window.open("https://www.baidu.com/s?wd="+selectTextNow)}),"2000"),removeRightMenu()}function switchReadMode(e){const t=document.body;let n;function o(){t.classList.remove("read-mode"),n.remove(),n.removeEventListener("click",o)}0!==e?(t.classList.add("read-mode"),n=document.createElement("button"),n.type="button",n.className="fas fa-sign-out-alt exit-readmode",t.appendChild(n),n.addEventListener("click",o)):o(),removeRightMenu()}document.onmouseup=document.ondbclick=selceText,window.oncontextmenu=function(e){if(document.body.clientWidth>768){let t=e.clientX+10,n=e.clientY,o=$(".rightMenuNormal"),i=$(".rightMenuOther"),c=$(".rightMenuPlugin"),r=$("#menu-copytext"),a=$("#menu-commenttext"),d=$("#menu-newwindow"),m=$("#menu-copylink"),u=$("#menu-copyimg"),h=$("#menu-downloadimg"),l=$("#menu-search"),g=$("#menu-searchBaidu"),s=$("#menu-readmode"),w=e.target.href,f=e.target.currentSrc,y=location.href.includes("posts"),k=!1;return o.show(),i.show(),selectTextNow&&window.getSelection()?(k=!0,r.show(),a.show(),l.show(),g.show(),i.hide()):(r.hide(),a.hide(),g.hide(),l.hide()),w||f?(k=!0,d.show(),m.show(),i.hide(),w&&(domhref=w),f?(domImgSrc=f,domhref=f,u.show(),h.show()):(u.hide(),h.hide())):(u.hide(),h.hide(),d.hide(),m.hide()),y?s.show():s.hide(),k?c.show():c.hide(),rm.reloadrmSize(),t+rmWidth>window.innerWidth&&(t-=rmWidth),n+rmHeight>window.innerHeight&&(n-=rmHeight),rm.showRightMenu(!0,n,t),$("#rightmenu-mask").attr("style","display: flex"),!1}},$("#menu-backward").on("click",(function(){window.history.back()})),$("#menu-forward").on("click",(function(){window.history.forward()})),$("#menu-refresh").on("click",(function(){window.location.reload()})),$("#menu-darkmode").on("click",(function(){removeRightMenu(),switchNightMode()})),$("#menu-translate").on("click",(function(){removeRightMenu(),document.getElementById("translateLink").click()})),$("#menu-home").on("click",(function(){window.location.href=window.location.origin})),$(".menu-link").on("click",(function(){removeRightMenu()})),rm.downloadimging=!1,$("#menu-copy").on("click",(function(){copyPageUrl()})),$("#menu-newwindow").on("click",(function(){window.open(domhref),removeRightMenu()})),$("#menu-copylink").on("click",(function(){rightmenuCopyText(domhref),btf.snackbarShow("已复制链接地址")})),$("#menu-copyimg").on("click",(function(){writeClipImg(domImgSrc)})),$("#menu-downloadimg").on("click",(function(){downloadImage(domImgSrc,"Jayhrn")})),$("#menu-copytext").on("click",(function(){rightmenuCopyText(selectTextNow,"add-copyright"),btf.snackbarShow("复制成功"),removeRightMenu()})),$("#menu-searchBaidu").on("click",(function(){searchBaidu()})),$("#menu-print").on("click",(function(){removeRightMenu(),window.print()})),$("#menu-readmode").on("click",(function(){switchReadMode(document.body.classList.length)})),$("#rightmenu-mask").on("click",(function(){removeRightMenu()})),$("#rightmenu-mask").contextmenu((function(){return removeRightMenu(),!1}));